# connect to timescale DB
function connect-timescale() {
  if [[ -z $CONTEXT ]];then
    echo "CONTEXT is required"
    return
  fi
  if [[ -z $NAMESPACE ]];then
    echo "NAMESPACE is required"
    return
  fi

  kubectl --context $CONTEXT -n $NAMESPACE exec -it timescaledb-0 -c timescaledb -- bash -c 'PGPASSWORD=$PATRONI_speedscale_PASSWORD psql --user speedscale $TIMESCALE_DB_NAME'
}

# connect to DB based on name
function connect-db() {
  NAME=$1
  if [[ -z $NAME ]];then
    echo "DB name is required"
    return
  fi

  if [[ "$NAME" =~ '^usr-mgmt' ]];then
    echo "connecting to usr-mgmt DB..."
    connect-usr-mgmt
  elif [[ "$NAME" =~ '^timescale' ]];then
    echo "connecting to timescale DB..."
    connect-timescale
  fi

  echo "no DB matched name $NAME"
  return
}

